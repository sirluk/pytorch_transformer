model_cfg_small:
  context_length: 512
  model_dim: 512
  n_blocks: 6
  n_attn_heads: 8
  k_config: 'mha'
  v_config: 'mha'
  kv_groups: null
  ffn_hidden_dim: null
  dropout_prob: 0.0
  bias: False
  norm_eps: 1e-5
  tie_word_embeddings: True
  ffn_hidden_dim_multiple_of: 256
model_cfg:
  context_length: 1024
  model_dim: 1024
  n_blocks: 16
  n_attn_heads: 16
  k_config: 'convx'
  v_config: 'gqa'
  kv_groups: 4
  ffn_hidden_dim: null
  dropout_prob: 0.0
  bias: False
  norm_eps: 1e-5
  tie_word_embeddings: True
  ffn_hidden_dim_multiple_of: 256
model_cfg_llama7b:
  context_length: 4096
  model_dim: 4096
  n_blocks: 32
  n_attn_heads: 32
  k_config: 'mha'
  v_config: 'mha'
  kv_groups: null
  ffn_hidden_dim: null # model_dim * 4
  dropout_prob: 0.0
  bias: False
  norm_eps: 1e-5
  tie_word_embeddings: False
  ffn_hidden_dim_multiple_of: 256
train_cfg:
  lr: 3e-4
  lr_min: 3e-5
  batch_size: 8
  adam_b1: 0.9
  adam_b2: 0.95
  adam_eps: 10e-6
  adam_weight_decay: 0.1
  gradient_accumulation_steps: 2
  max_grad: 1.0
  train_iters: 6e5
  warmup_iters: 2000
  eval_interval: 2000
  eval_iters: 200
  track_memory: True
qq_model_cfg:
  context_length: 1024
  model_dim: 1024
  n_blocks: 16
  n_attn_heads: 16
  ffn_hidden_dim: null
  dropout_prob: 0.0
  bias: False
  norm_eps: 1e-5
  tie_word_embeddings: True
  ffn_hidden_dim_multiple_of: 256
  k_config: 'conv'
  v_config: 'conv'
  gqa_groups: 4
  controller_alpha: 1e-2
  controller_k: 1
  controller_temperature: 1.0
qq_model_cfg_small:
  context_length: 512
  model_dim: 512
  n_blocks: 6
  n_attn_heads: 8
  ffn_hidden_dim: null
  dropout_prob: 0.0
  bias: False
  norm_eps: 1e-5
  tie_word_embeddings: True
  ffn_hidden_dim_multiple_of: 256Hi 
  k_config: 'qq'
  v_config: 'qq'
  gqa_groups: 4
  controller_alpha: 1e-2
  controller_k: 1
  controller_temperature: 1.0
qq_model_cfg_llama7b:
  context_length: 4096
  model_dim: 4096
  n_blocks: 32
  n_attn_heads: 32
  ffn_hidden_dim: null # model_dim * 4
  dropout_prob: 0.0
  bias: False
  norm_eps: 1e-5
  tie_word_embeddings: False
  ffn_hidden_dim_multiple_of: 256
  k_config: 'qq'
  v_config: 'qq'
  gqa_groups: 4
  controller_alpha: 1e-2
  controller_k: 1
  controller_temperature: 1.0